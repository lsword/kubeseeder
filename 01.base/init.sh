#!/bin/bash

#==================================================================================================================
# Install tools
#------------------------------------------------------------------------------------------------------------------
> y | cp ../tools/bin/* /usr/local/bin

#==================================================================================================================
# Read Config
#------------------------------------------------------------------------------------------------------------------
OS_RELEASE=$(yq '.os.release' ../config.yaml)
K8S_VERSION=$(yq '.k8s.version' ../config.yaml)
K8S_INSTALLMODE=$(yq '.k8s.installMode' ../config.yaml)

#==================================================================================================================
# Init OS
#------------------------------------------------------------------------------------------------------------------
./initos.sh
if [ $? -ne 0 ]; then
  echo "initos error"
  exit 1
fi

#==================================================================================================================
# Online Install
#------------------------------------------------------------------------------------------------------------------

if [ $K8S_INSTALLMODE == "online" ];then
  ./install_online.sh
  exit 0
fi

#==================================================================================================================
# Offline Install
#------------------------------------------------------------------------------------------------------------------
./install_offline.sh
